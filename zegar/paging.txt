WYKRYCIE_ILOSCI_PAMIECI PROC    		
;Procedura zak³ada istnienie co najmniej 1064 kB
  PUSH AX                       					
  MOV AX, DS                    				
  PUSH AX                       					
  MOV AX, ES                    				
  PUSH AX                       					
  MOV AX, 56                 				
  MOV ES, AX 			;Adres segmentu o zmiennej bazie
  MOV EAX, 110000H              				
  MOV DL, 1                    				
  XOR DH, DH                    				
  XOR DI, DI                    				
  MOV BX, OFFSET   GDT_DESKRYPTOR_ZMIENNEGO_ADRESU   
  PETLA_PROBKOWANIA_PAMIECI:   
    MOV	CL, [ES:DI]      	
    MOV [ES:DI], DL                                			 
    MOV DH, [ES:DI]
    MOV [ES:DI], CL                                 			
    CMP DL, DH                                      			
    JNE KONIEC_PAMIECI                              			
    XOR DH, DH                                      			
    CMP DI, 0FFFFH                                  			
    JE PRZEKROCZENIE_ZAKRESU_REJESTRU_INDEKSOWEGO   
    INC DI                                       				
    INC EAX                                      				
    JMP PETLA_PROBKOWANIA_PAMIECI                		
    PRZEKROCZENIE_ZAKRESU_REJESTRU_INDEKSOWEGO:     
      INC EAX                                      			
      XOR DI, DI                                   			
      ROL EAX, 8                                   			
      MOV  [BX].BASE_H, AL                         			
      ROL EAX, 8                                   			
      MOV [BX].BASE_M, AL                          			
      ROL EAX, 16                                  			
      MOV [BX].BASE_1, AX                          			
      CALL DRUKUJ_HEX                              			
    JMP  PETLA_PROBKOWANIA_PAMIECI                     		
    KONIEC_PAMIECI:                                    			
  MOV ILOSC_PAMIECI, EAX                             			
  CALL DRUKUJ_HEX                                    			
  POP AX                                                		
  MOV ES, AX                                            		
  POP AX                                                		
  MOV DS, AX                                            		
  POP AX                                                		
  RET                                                   		
WYKRYCIE_ILOSCI_PAMIECI ENDP                          			

